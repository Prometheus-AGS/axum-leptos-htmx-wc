<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Aspect Ratio — HTMX Variations (single file)</title>

  <!-- HTMX included via CDN for portable HTMX artifacts. [5] -->
  <script src="https://unpkg.com/htmx.org@1.9.12"></script>

  <style>
    :root{
      --primary-hue: 210;
      --primary: hsl(var(--primary-hue) 60% 55%);
      --on-surface: hsl(var(--primary-hue) 15% 92%);
      --on-surface-variant: hsl(var(--primary-hue) 10% 70%);
      --surface-container-lowest: hsl(var(--primary-hue) 15% 9%);
      --surface-container-low: hsl(var(--primary-hue) 14% 12%);
      --surface-container: hsl(var(--primary-hue) 14% 14%);
      --surface-container-high: hsl(var(--primary-hue) 14% 17%);
      --shadow: 0 18px 45px rgba(0,0,0,.55), 0 2px 10px rgba(0,0,0,.38);
      --r-lg: 16px;
      --transition-base: 300ms cubic-bezier(.4,0,.2,1);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0; padding:22px;
      font-family: var(--sans);
      background: radial-gradient(circle at top left, var(--surface-container-lowest) 0, #000 100%);
      color: var(--on-surface);
    }
    .wrap{max-width:1100px; margin:0 auto;}
    .zone-card{
      background: var(--surface-container-low);
      border-radius: var(--r-lg);
      padding: 16px;
      box-shadow: var(--shadow);
      transition: background var(--transition-base);
    }
    h1{font-size:16px; margin:0 0 6px 0;}
    .sub{color:var(--on-surface-variant); font-size:13px; margin:0 0 14px 0; line-height:1.4;}
    .grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(320px,1fr)); gap:12px;}
    .panel{background: var(--surface-container); border-radius: var(--r-lg); padding: 12px;}
    .titleRow{display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:10px;}
    .title{font-size:13px; font-weight:650;}
    .pill{
      font-size:11px;
      color: var(--on-surface-variant);
      background: color-mix(in srgb, var(--surface-container-high) 70%, transparent);
      padding: 3px 8px;
      border-radius: 999px;
      font-family: var(--mono);
    }
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top: 10px;}
    .btn{
      height: 36px; padding: 0 12px;
      border-radius: 12px;
      background: color-mix(in srgb, var(--primary) 16%, transparent);
      color: var(--on-surface);
      border: 0;
      cursor:pointer;
      font-size:12px;
    }
    .frame{border-radius: var(--r-lg); background: var(--surface-container-high); padding: 10px;}

    /* Aspect ratio: native CSS aspect-ratio + optional fallback. */
    .ratio{
      width: 100%;
      border-radius: 14px;
      overflow: hidden;
      background: rgba(0,0,0,.25);
      position: relative;
    }
    .ratio[data-ratio]{
      aspect-ratio: var(--ar, 16 / 9);
      transition: all var(--transition-base);
    }
    .ratio.fallback::before{
      content:"";
      display:block;
      padding-top: var(--pt, 56.25%);
    }
    .ratio > .content{
      position:absolute; inset:0;
      display:grid; place-items:center;
      color: var(--on-surface);
      font-weight: 700;
      letter-spacing:.02em;
    }
    .thumb{
      position:absolute; inset:0;
      background:
        radial-gradient(circle at 30% 20%, rgba(96,165,250,.28), transparent 55%),
        radial-gradient(circle at 80% 70%, rgba(96,165,250,.20), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.20));
    }

    .out{
      margin-top:10px;
      padding:10px;
      border-radius: var(--r-lg);
      background: var(--surface-container-low);
      color: var(--on-surface-variant);
      font-size:12px;
      min-height: 48px;
    }
    .indicator{display:none; align-items:center; gap:8px; font-size:12px; color: var(--on-surface-variant); margin-top:10px;}
    .htmx-request.indicator{display:flex;}
    .dot{width:10px;height:10px;border-radius:999px;background: color-mix(in srgb, var(--primary) 70%, #000); box-shadow:0 0 0 3px color-mix(in srgb, var(--primary) 20%, transparent);}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="zone-card">
      <h1>Aspect Ratio — HTMX variations</h1>
      <p class="sub">
        Standalone HTMX artifact with zone-based surfaces and token theming. [4][6]
      </p>

      <div class="grid">

        <!-- 1) Static ratios -->
        <div class="panel">
          <div class="titleRow">
            <div class="title">1) Static ratio presets</div>
            <div class="pill">16:9 • 1:1 • 4:3</div>
          </div>

          <div class="frame">
            <div class="ratio" data-ratio style="--ar: 16 / 9;">
              <div class="thumb"></div>
              <div class="content">16:9</div>
            </div>
          </div>

          <div class="row">
            <div class="frame" style="flex:1">
              <div class="ratio" data-ratio style="--ar: 1 / 1;">
                <div class="thumb"></div>
                <div class="content">1:1</div>
              </div>
            </div>
            <div class="frame" style="flex:1">
              <div class="ratio" data-ratio style="--ar: 4 / 3;">
                <div class="thumb"></div>
                <div class="content">4:3</div>
              </div>
            </div>
          </div>
        </div>

        <!-- 2) HTMX swaps the ratio block -->
        <div class="panel">
          <div class="titleRow">
            <div class="title">2) Swap ratio via HTMX (hx-get)</div>
            <div class="pill">fragment swap</div>
          </div>

          <div class="row" style="margin-top:0">
            <button class="btn" hx-get="/fake/ar?ratio=16/9&label=16:9" hx-target="#arHost" hx-swap="innerHTML" hx-indicator="#ind-ar">16:9</button>
            <button class="btn" hx-get="/fake/ar?ratio=1/1&label=1:1" hx-target="#arHost" hx-swap="innerHTML" hx-indicator="#ind-ar">1:1</button>
            <button class="btn" hx-get="/fake/ar?ratio=21/9&label=21:9" hx-target="#arHost" hx-swap="innerHTML" hx-indicator="#ind-ar">21:9</button>
          </div>

          <div id="ind-ar" class="indicator"><span class="dot"></span> Swapping…</div>

          <div id="arHost" class="frame" style="margin-top:10px">
            <div class="ratio" data-ratio style="--ar: 16 / 9;">
              <div class="thumb"></div>
              <div class="content">16:9</div>
            </div>
          </div>

          <div class="out">
            Demonstrates scoped fragment swaps into a host container (partial update pattern). [27]
          </div>
        </div>

        <!-- 3) Fallback -->
        <div class="panel">
          <div class="titleRow">
            <div class="title">3) Fallback pattern (padding-top)</div>
            <div class="pill">no aspect-ratio</div>
          </div>

          <div class="frame">
            <div class="ratio fallback" style="--pt: 56.25%;">
              <div class="thumb"></div>
              <div class="content">Fallback 16:9</div>
            </div>
          </div>

          <div class="out">
            Use the padding-top fallback if you need to support environments without native <span style="font-family:var(--mono)">aspect-ratio</span>.
          </div>
        </div>

      </div>
    </div>
  </div>

  <script>
    // Fake backend for standalone swapping; real server would return HTML fragments. [4]
    document.body.addEventListener("htmx:configRequest", (evt) => {
      const path = evt.detail.path || evt.detail.requestConfig?.path;
      if(!path || !path.startsWith("/fake/")) return;
      evt.preventDefault();

      const elt = evt.detail.elt;
      const targetSel = elt?.getAttribute("hx-target");
      const target = targetSel ? document.querySelector(targetSel) : null;

      setTimeout(() => {
        if(path.startsWith("/fake/ar")){
          const url = new URL("http://x" + path);
          const ratio = url.searchParams.get("ratio") || "16/9";
          const label = url.searchParams.get("label") || ratio;
          const [a,b] = ratio.split("/").map(Number);
          const ar = `${a} / ${b}`;
          if(target) target.innerHTML = `
            <div class="ratio" data-ratio style="--ar: ${ar};">
              <div class="thumb"></div>
              <div class="content">${escapeHtml(label)}</div>
            </div>
          `;
        }
      }, 180);

      function escapeHtml(s){
        return String(s).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;");
      }
    });
  </script>
</body>
</html>
