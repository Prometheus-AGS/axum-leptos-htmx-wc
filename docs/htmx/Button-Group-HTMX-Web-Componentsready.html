<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Button Group (HTMX + Web Components-ready)</title>

    <!-- HTMX 2.0.8 usage + patterns. [11] -->
    <script src="https://unpkg.com/htmx.org@2.0.8"></script>

    <style>
      /* ============================================================
         Material Zones / borderless component styling. [10][2]
         - No borders on controls; use surfaces + shadows. [10]
         - Mobile breakpoint at 768px (consistent with Zones patterns). [10]
         - Accessibility: visible focus states via :focus-visible. [11]
      ============================================================ */
      :root {
        --primary-hue: 210;
        --primary: hsl(var(--primary-hue) 60% 50%);
        --on-primary: hsl(var(--primary-hue) 100% 98%);

        --surface-lowest: hsl(var(--primary-hue) 10% 8%);
        --surface-low: hsl(var(--primary-hue) 11% 10%);
        --surface: hsl(var(--primary-hue) 12% 12%);
        --surface-high: hsl(var(--primary-hue) 14% 16%);

        --on-surface: hsl(var(--primary-hue) 18% 92%);
        --on-surface-variant: hsl(var(--primary-hue) 10% 70%);

        --ring: color-mix(in oklab, var(--primary) 55%, transparent);
        --shadow-1: 0 1px 2px rgba(0, 0, 0, 0.4);
        --shadow-2: 0 18px 44px rgba(0, 0, 0, 0.58);

        --r-xl: 20px;
        --r-lg: 14px;
        --r-md: 12px;

        --sp-2: 10px;
        --sp-3: 14px;
        --sp-4: 18px;
        --sp-5: 24px;

        --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      }

      html[data-theme="light"] {
        --surface-lowest: hsl(var(--primary-hue) 8% 98%);
        --surface-low: hsl(var(--primary-hue) 10% 96%);
        --surface: hsl(var(--primary-hue) 12% 94%);
        --surface-high: hsl(var(--primary-hue) 14% 92%);

        --on-surface: hsl(var(--primary-hue) 15% 14%);
        --on-surface-variant: hsl(var(--primary-hue) 10% 35%);

        --shadow-1: 0 1px 2px rgba(0, 0, 0, 0.08);
        --shadow-2: 0 18px 44px rgba(0, 0, 0, 0.14);
      }

      * { box-sizing: border-box; }
      body {
        margin: 0;
        font-family: var(--font);
        color: var(--on-surface);
        background: radial-gradient(circle at top left, var(--surface-lowest) 0%, var(--surface) 55%, #000 140%);
        padding: var(--sp-5);
      }

      .shell { max-width: 1120px; margin: 0 auto; display: grid; gap: var(--sp-4); }
      .zone {
        background: var(--surface-low);
        border-radius: var(--r-xl);
        padding: var(--sp-5);
        box-shadow: var(--shadow-2);
      }

      .row { display:flex; flex-wrap:wrap; gap: var(--sp-3); align-items:center; justify-content:space-between; }
      h1 { margin: 0; font-size: 1.1rem; font-weight: 950; letter-spacing: .2px; }
      .sub { margin: 8px 0 0; color: var(--on-surface-variant); line-height: 1.35; }

      .btn {
        border: none; /* borderless principle [10] */
        border-radius: 999px;
        padding: 10px 14px;
        cursor: pointer;
        font-weight: 900;
        box-shadow: var(--shadow-1);
        background: var(--surface-high);
        color: var(--on-surface);
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }
      .btn-primary { background: var(--primary); color: var(--on-primary); }
      .btn:focus-visible { outline: 3px solid var(--ring); outline-offset: 2px; } /* a11y requirement [11] */

      .card {
        background: var(--surface-high);
        border-radius: var(--r-xl);
        box-shadow: var(--shadow-1);
        padding: var(--sp-4);
        display: grid;
        gap: 12px;
      }

      /* ============================================================
         Button Group styles (segmented control)
         - Implemented as a “group surface” + child buttons.
         - Rounded group, no borders; rely on surfaces/shadows. [10]
      ============================================================ */
      .bg-group {
        display: inline-flex;
        gap: 6px;
        padding: 6px;
        border-radius: 999px;
        background: color-mix(in oklab, var(--surface) 85%, transparent);
        box-shadow: var(--shadow-1);
      }

      .bg-item {
        border: none;
        cursor: pointer;
        font-weight: 900;
        border-radius: 999px;
        padding: 10px 12px;
        background: transparent;
        color: var(--on-surface);
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }

      .bg-item:hover {
        background: color-mix(in oklab, var(--surface-high) 75%, transparent);
      }

      .bg-item[aria-pressed="true"],
      .bg-item[aria-checked="true"] {
        background: var(--primary);
        color: var(--on-primary);
        box-shadow: var(--shadow-1);
      }

      .bg-item:focus-visible { outline: 3px solid var(--ring); outline-offset: 2px; } /* [11] */

      .bg-item--icon {
        width: 44px;
        justify-content: center;
        padding: 10px 0;
      }

      /* size variants (for web component props) */
      .bg-group[data-size="sm"] .bg-item { padding: 8px 10px; font-size: 0.92rem; }
      .bg-group[data-size="md"] .bg-item { padding: 10px 12px; font-size: 1rem; }
      .bg-group[data-size="lg"] .bg-item { padding: 12px 14px; font-size: 1.05rem; }

      /* disabled */
      .bg-item[disabled] {
        opacity: 0.55;
        cursor: not-allowed;
      }

      /* responsive: stack for mobile <768 if desired [10] */
      @media (max-width: 768px) {
        .bg-group[data-wrap="stack"] {
          border-radius: var(--r-xl);
          display: grid;
          grid-auto-flow: row;
          justify-content: stretch;
        }
        .bg-group[data-wrap="stack"] .bg-item {
          justify-content: space-between;
          border-radius: var(--r-lg);
        }
      }

      .kv {
        display: grid;
        gap: 6px;
        color: var(--on-surface-variant);
        font-size: 0.92rem;
      }

      code {
        background: color-mix(in oklab, var(--surface) 75%, transparent);
        padding: 2px 8px;
        border-radius: 10px;
        box-shadow: var(--shadow-1);
      }

      .result {
        padding: 12px;
        border-radius: var(--r-lg);
        background: color-mix(in oklab, var(--surface) 86%, transparent);
        box-shadow: var(--shadow-1);
        color: var(--on-surface-variant);
        min-height: 44px;
      }
    </style>
  </head>

  <body>
    <div class="shell">
      <section class="zone">
        <div class="row">
          <div>
            <h1>Button Group (HTMX + Web Components boundaries)</h1>
            <p class="sub">
              Demonstrates segmented/single-select, multi-select toggles, icon-only groups, and a split-button pattern using HTMX attributes and keyboard-visible focus states. [11]
            </p>
          </div>
          <div style="display:flex; gap:10px; align-items:center;">
            <button class="btn" type="button" id="themeToggle">Toggle Theme</button>
          </div>
        </div>

        <div style="height: var(--sp-4)"></div>

        <div class="card">
          <div style="font-weight: 950;">Variation 1 — Single-select segmented (radio-like)</div>

          <!-- ============================================================
               <wc-button-group> boundary
               Suggested props:
                 - selection: "single" | "multiple"
                 - value / values
                 - size: "sm" | "md" | "lg"
                 - wrap: "inline" | "stack"
                 - disabled: bool
               Accessibility patterns: keyboard focus + pressed/checked states. [11]
          ============================================================ -->
          <div class="bg-group" data-size="md" data-wrap="inline"
               role="radiogroup" aria-label="Text alignment"
               data-selection="single" data-value="left" id="bgSingle">

            <!-- <wc-button-group-item value="left"> boundary -->
            <button class="bg-item" type="button" role="radio"
                    aria-checked="true" data-value="left">
              Left
            </button>

            <!-- <wc-button-group-item value="center"> boundary -->
            <button class="bg-item" type="button" role="radio"
                    aria-checked="false" data-value="center">
              Center
            </button>

            <!-- <wc-button-group-item value="right"> boundary -->
            <button class="bg-item" type="button" role="radio"
                    aria-checked="false" data-value="right">
              Right
            </button>
          </div>

          <div class="kv">
            <div>HTMX usage idea: group selection can drive a fragment reload via <code>hx-get</code> + <code>hx-target</code> + <code>hx-swap</code>. [26]</div>
          </div>

          <!-- demo “target” -->
          <div class="result" id="singleResult">
            Selected: <strong>left</strong>
          </div>
        </div>

        <div class="card">
          <div style="font-weight: 950;">Variation 2 — Multi-select toggles (pressed buttons)</div>

          <!-- ============================================================
               <wc-button-group selection="multiple"> boundary
          ============================================================ -->
          <div class="bg-group" data-size="md" data-wrap="inline"
               role="group" aria-label="Filters"
               data-selection="multiple" id="bgMulti">

            <button class="bg-item" type="button"
                    aria-pressed="false" data-value="drafts">
              Drafts
            </button>

            <button class="bg-item" type="button"
                    aria-pressed="true" data-value="published">
              Published
            </button>

            <button class="bg-item" type="button"
                    aria-pressed="false" data-value="archived">
              Archived
            </button>
          </div>

          <!-- HTMX pattern example: optimistic UI and swap (illustrative). [11] -->
          <div class="kv">
            <div>
              Example HTMX pattern: <code>hx-post</code> from a button and show loading via <code>hx-indicator</code>. [11]
            </div>
          </div>

          <div class="result" id="multiResult">
            Active filters: <strong>published</strong>
          </div>
        </div>

        <div class="card">
          <div style="font-weight: 950;">Variation 3 — Icon-only group</div>

          <!-- ============================================================
               <wc-button-group> boundary (icon buttons)
               For icon buttons, treat as normal buttons but keep keyboard focus visible. [11]
          ============================================================ -->
          <div class="bg-group" data-size="md" data-wrap="inline"
               role="radiogroup" aria-label="View mode"
               data-selection="single" data-value="grid" id="bgIcons">

            <button class="bg-item bg-item--icon" type="button" role="radio"
                    aria-checked="true" data-value="grid" aria-label="Grid view">
              <!-- tiny inline SVG icon -->
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M4 4h7v7H4V4Zm9 0h7v7h-7V4ZM4 13h7v7H4v-7Zm9 0h7v7h-7v-7Z" fill="currentColor"/>
              </svg>
            </button>

            <button class="bg-item bg-item--icon" type="button" role="radio"
                    aria-checked="false" data-value="list" aria-label="List view">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M4 6h16v2H4V6Zm0 5h16v2H4v-2Zm0 5h16v2H4v-2Z" fill="currentColor"/>
              </svg>
            </button>

            <button class="bg-item bg-item--icon" type="button" role="radio"
                    aria-checked="false" data-value="compact" aria-label="Compact view">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M5 7h14v2H5V7Zm0 4h10v2H5v-2Zm0 4h14v2H5v-2Z" fill="currentColor"/>
              </svg>
            </button>
          </div>

          <div class="result" id="iconResult">
            View: <strong>grid</strong>
          </div>
        </div>

        <div class="card">
          <div style="font-weight: 950;">Variation 4 — Split button (primary + dropdown-ish)</div>

          <!-- ============================================================
               <wc-split-button> boundary
               - primary action button
               - secondary “more” button
               - optional menu (not implemented as a full menu component here)
               HTMX: primary can trigger hx-post; secondary can hx-get a fragment. [11][26]
          ============================================================ -->
          <div class="bg-group" data-size="md" data-wrap="inline" role="group" aria-label="Split button">
            <button class="bg-item" type="button"
                    hx-post="/api/run"
                    hx-target="#splitResult"
                    hx-swap="innerHTML">
              Run
              <span class="htmx-indicator" id="splitSpinner" style="display:none;"></span>
            </button>

            <button class="bg-item bg-item--icon" type="button"
                    aria-label="More actions"
                    hx-get="/api/run/options"
                    hx-target="#splitResult"
                    hx-swap="innerHTML">
              ▾
            </button>
          </div>

          <div class="kv">
            <div>
              This illustrates using HTMX attributes on buttons (<code>hx-post</code>/<code>hx-get</code>/<code>hx-target</code>/<code>hx-swap</code>) as documented patterns. [11][26]
            </div>
          </div>

          <div class="result" id="splitResult">
            Split result target (server would return an HTML fragment).
          </div>
        </div>

        <div class="card">
          <div style="font-weight: 950;">Variation 5 — Disabled group + responsive stacking (mobile)</div>

          <!-- ============================================================
               <wc-button-group disabled wrap="stack"> boundary
               Demonstrates 768px breakpoint stacking behavior. [10]
          ============================================================ -->
          <div class="bg-group" data-size="md" data-wrap="stack"
               role="radiogroup" aria-label="Disabled group"
               data-selection="single" data-value="a" id="bgDisabled">
            <button class="bg-item" type="button" role="radio" aria-checked="true" data-value="a" disabled>Option A</button>
            <button class="bg-item" type="button" role="radio" aria-checked="false" data-value="b" disabled>Option B</button>
            <button class="bg-item" type="button" role="radio" aria-checked="false" data-value="c" disabled>Option C</button>
          </div>

          <div class="kv">
            <div>On screens ≤768px the group stacks when <code>data-wrap="stack"</code> is set. [10]</div>
          </div>
        </div>
      </section>
    </div>

    <script>
      // Theme toggle (token-driven).
      document.getElementById("themeToggle").addEventListener("click", () => {
        const root = document.documentElement;
        const current = root.getAttribute("data-theme") || "dark";
        root.setAttribute("data-theme", current === "dark" ? "light" : "dark");
      });

      // ============================================================
      // ButtonGroup behavior (vanilla JS)
      // - Single selection: roving “aria-checked” within radiogroup
      // - Multi selection: toggle “aria-pressed”
      // Keep keyboard accessible and maintain focus visibility. [11]
      // ============================================================
      function initSingleGroup(rootEl, resultEl) {
        rootEl.addEventListener("click", (e) => {
          const btn = e.target.closest("button[data-value]");
          if (!btn || btn.disabled) return;

          const value = btn.getAttribute("data-value");
          rootEl.querySelectorAll("button[data-value]").forEach((b) => {
            b.setAttribute("aria-checked", b === btn ? "true" : "false");
          });

          resultEl.innerHTML = `Selected: <strong>${value}</strong>`;
        });

        // Keyboard: arrow navigation for radio-like groups (basic)
        rootEl.addEventListener("keydown", (e) => {
          const keys = ["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"];
          if (!keys.includes(e.key)) return;

          const items = Array.from(rootEl.querySelectorAll("button[data-value]"));
          const idx = items.indexOf(document.activeElement);
          if (idx === -1) return;

          e.preventDefault();
          const dir = (e.key === "ArrowLeft" || e.key === "ArrowUp") ? -1 : 1;
          const next = items[(idx + dir + items.length) % items.length];
          next.focus();
          next.click();
        });
      }

      function initMultiGroup(rootEl, resultEl) {
        function report() {
          const active = Array.from(rootEl.querySelectorAll('button[aria-pressed="true"]'))
            .map((b) => b.getAttribute("data-value"));
          resultEl.innerHTML = `Active filters: <strong>${active.length ? active.join(", ") : "none"}</strong>`;
        }

        rootEl.addEventListener("click", (e) => {
          const btn = e.target.closest("button[data-value]");
          if (!btn || btn.disabled) return;
          const cur = btn.getAttribute("aria-pressed") === "true";
          btn.setAttribute("aria-pressed", cur ? "false" : "true");
          report();
        });

        report();
      }

      // Mount demos
      initSingleGroup(document.getElementById("bgSingle"), document.getElementById("singleResult"));
      initMultiGroup(document.getElementById("bgMulti"), document.getElementById("multiResult"));
      initSingleGroup(document.getElementById("bgIcons"), document.getElementById("iconResult"));
    </script>
  </body>
</html>
